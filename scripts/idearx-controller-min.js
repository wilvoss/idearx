Vue.config.devtools=!1,Vue.config.debug=!1,Vue.config.silent=!0,Vue.config.ignoredElements=["app"];var app=new Vue({el:"#app",data:{appVersion:"0.0.041",allMethods:Methods,allIdeaSets:IdeaSets,allViews:Views,currentIdeaSet:new IdeaSetObject({}),currentIdeas:null,currentSelectedIdea:null,currentSelectedAIAction:new AIActionObject({}),currentIdeaQueryString:"",currentMethod:new MethodObject({}),currentView:Views[0],currentMethodType:"",currentExerciseIsDirty:!1,selectedIdeasPath:[],ideasLIFOForUndo:[],ideasLIFOForRedo:[],visualStateLastInputEvent:null,visualStateShowModal:!1},methods:{async SelectIdeaSet(e,t){if(note("async SelectIdeaSet() called"),this.currentIdeaSet=void 0===t?this.currentIdeaSet:t,null!==this.currentIdeaSet.data){let e=Array.isArray(this.currentIdeaSet.data)?await this.GetCurrentIdeasJSON():this.currentIdeaSet.data;this.currentIdeas=createNestedIdeaObject(e),this.currentMethod=this.currentIdeaSet.method,this.SoftRestartExercise()}},SelectIdea(e){if(note("SelectIdea() called"),"binary"===this.currentMethod.value){let t=0;e.parent.children&&e.parent.children.length>0&&(t=e.parent.children.length,Array.from(e.parent.children).forEach((e=>{e.isSelected=!1,e.seen=e.showing,e.seen&&(t-=1)}))),e.isSelected=!0,e.lowestSelectedDescendent="",0===t&&(this.currentSelectedIdea=e,this.selectedIdeasPath.push(e))}else e.isSelected=!0,this.currentSelectedIdea=e,this.selectedIdeasPath.push(e);this.ideasLIFOForUndo.push(e),this.currentExerciseIsDirty=!0,this.MoveFocus()},MoveFocus(){note("MoveFocus() called"),"keydown"===this.visualStateLastInputEvent&&this.$nextTick((()=>{void 0===this.getLastSelectedIdea||this.getLastSelectedIdea.children.length>0||0===this.selectedIdeasPath.length?document.getElementById("idpicker").firstChild.focus():this.showAIActions?document.getElementById("aiactions").firstChild.focus():document.getElementById("button-restart").focus()}))},UndoLastIdea(){if(this.ideasLIFOForUndo.length>0){note("UndoLastIdea() called");let e=this.ideasLIFOForUndo.pop();e.lowestSelectedDescendent="",this.ideasLIFOForRedo.push(e),"binary"!==this.currentMethod.value?(this.ResetIdea(e,!0),this.MoveFocus(),this.selectedIdeasPath.pop()):e&&(this.getLastSelectedIdea===e?(this.selectedIdeasPath.pop(),void 0!==e.parent?e.parent===this.currentIdeas?this.SoftRestartExercise():(this.currentSelectedIdea=e.parent,e.parent.children.forEach((e=>{this.ResetIdea(e,!0),this.MoveFocus()}))):this.SoftRestartExercise(e)):(this.ResetIdea(e,!0),this.MoveFocus()))}},RedoLastIdea(){if(this.ideasLIFOForRedo.length>0){note("RedoLastIdea() called");let e=this.ideasLIFOForRedo.pop();e?this.SelectIdea(e):this.MoveFocus()}},async GetCurrentIdeasJSON(){note("async GetCurrentIdeasJSON() called");let e=[],t=this.currentIdeaSet.data.map((e=>fetch(e).then((e=>e.json()))));try{let r=await Promise.all(t);e=[].concat(...r)}catch(e){e(e)}return e[0]},HardRestartExercise(){note("HardRestartExercise() called"),this.currentIdeas.children.forEach((e=>{e.lowestSelectedDescendent=""})),this.ideasLIFOForRedo=[],this.SoftRestartExercise()},SoftRestartExercise(){note("SoftRestartExercise() called"),this.selectedIdeasPath=[],this.ideasLIFOForUndo=[],this.currentExerciseIsDirty=!1,this.currentSelectedIdea=this.currentIdeas,this.currentMethodType=this.currentMethod.value,this.ResetIdea(this.currentIdeas),this.currentIdeas.isSelected=!0,this.currentIdeas.seen=!0,this.MoveFocus()},PrintTree(e,t=0){note("PrintTree() called");0===t||" ".repeat(4*t-1),e.isSelected;for(let r of e.children)this.PrintTree(r,t+1)},HasSelected:e=>e.some((e=>e.isSelected)),GetFirstUnfinishedGenerationOfExploredLineage(){function e(t){if(!t.children.length)return null;if(!app.HasSelected(t.children))return t.children;for(let r of t.children)if(r.isSelected){const t=e(r);if(t)return t}return null}note("GetFirstUnfinishedGenerationOfExploredLineage() called");const t=this.currentIdeas.children;for(let r of t)if(r.isSelected){const t=e(r);if(t)return t}return t},FindDeepestSelected(e){note("FindDeepestSelected() called");let t=null;return function e(r){if(r.isSelected&&(t=r),r.children&&r.children.length>0)for(let t of r.children)e(t)}(e),t},SortIdeasByOrderThenAlphabetically:e=>(note("SortIdeasByOrderThenAlphabetically() called"),e.sort(((e,t)=>e.order<t.order?-1:e.order>t.order?1:e.name<t.name?-1:e.name>t.name?1:0))),ResetIdea(e,t=!1){t&&highlight('Undoing "'+e.name+'"'),e.isSelected=!1,e.seen=!1,e.showing=!1,e.children&&e.children.length>0&&e.children.forEach((e=>{this.ResetIdea(e)}))},ValidateInput(e,t){if(e.preventDefault(),e.stopPropagation(),t.pattern&&""!==t.pattern){const e=new RegExp(t.pattern,"u");t.value=t.value.split("").filter((t=>e.test(t))).join("")}},OpenNewWindowWithURL(e){window.open(e.trim(),"_blank")},PreFillForDevelopment(e){note("PreFillForDevelopment() called"),this.SelectIdeaSet(e,this.allIdeaSets[1])},HandleActionAIClick(e,t){if(note("HandleActionAIClick() called"),e.preventDefault(),e.stopPropagation(),this.currentSelectedAIAction=t,""!==t.url)window.open(t.url,"_blank");else{let e=[];this.getLowestSelectedDescendantsComputed.forEach((t=>{""!==t.searchName?e.push('"'+t.searchName+'"'):e.push('"'+t.name+'"')})),this.currentIdeaQueryString=e.join(" ").toLowerCase().replace("find","");const r=" "+t.request.toLowerCase().replace("find","").trim();"map"===t.type?(this.currentIdeaQueryString=this.currentIdeaQueryString.replace("local","").replace("nearby",""),this.currentIdeaQueryString=this.currentIdeaQueryString.replace("  ",""),this.currentIdeaQueryString=this.currentIdeaQueryString.trim()+r,this.currentIdeaQueryString=this.currentIdeaQueryString.replace("  ",""),t.inputs.length>0?(this.visualStateShowModal=!0,this.$nextTick((()=>{document.getElementsByTagName("input")[0].select()}))):this.OpenNewWindowWithURL("https://google.com/maps/?q="+this.currentIdeaQueryString)):this.OpenNewWindowWithURL("https://duckduckgo.com/?q="+this.currentIdeaQueryString+r)}},HandleInputFormSubmitClicked(){for(let e=0;e<this.currentSelectedAIAction.inputs.length;e++){const t=this.currentSelectedAIAction.inputs[e];this.currentIdeaQueryString=this.currentIdeaQueryString+" "+t.value}this.OpenNewWindowWithURL("https://google.com/maps/?q="+this.currentIdeaQueryString),this.visualStateShowModal=!1},HandleKeyDown(e){switch(note("HandleKeyDown() called"),this.visualStateLastInputEvent="keydown",e.key){case"z":case"Z":this.currentMethod.allowUndo&&e.metaKey&&(e.shiftKey?this.RedoLastIdea():this.UndoLastIdea());break;case"Tab":this.currentIdeas&&0===this.selectedIdeasPath.length&&e.target.tagName.toLowerCase();break;case"Escape":this.visualStateShowModal=!1;break;case"Enter":this.visualStateShowModal&&this.HandleInputFormSubmitClicked();break;default:break}},HandleMouseUp(){note("HandleMouseUp() called"),this.visualStateLastInputEvent="mouseup"},TriggerFileUpload(){note("TriggerFileUpload() called"),this.$refs.fileInput.click()},HandleUploadLinkClick(e){note("HandleUploadLinkClick() called");const t=e.target.files[0];if(t){const r=new FileReader;r.onload=r=>{const s=r.target.result;let n;if("application/json"===t.type?n=JSON.parse(s):"text/csv"!==t.type&&"text/plain"!==t.type||(n=this.ConvertToJSON(s,t.name.split(".")[0])),n){const r=this.TransformJson(n);let s=new IdeaSetObject({name:"ðŸ–¹ "+r.name,value:r.name,cta:"",description:"",method:"application/json"===t.type?this.allMethods[0]:this.allMethods[1],data:r});this.allIdeaSets=this.allIdeaSets.filter((e=>e.value!==s.value)),this.allIdeaSets.push(s),this.SelectIdeaSet(e,s)}},r.readAsText(t)}},TransformJson(e){note("TransformJson() called");const t=(r,s=null)=>{if(Array.isArray(r))return r.map((e=>t(e)));if("object"==typeof r&&null!==r){const n={};e.hsl?"random"!==e.hsl&&(n.hsl=e.hsl,n.hslUsePreset=!0):n.hsl="0, 0%, 90%";const a=Object.keys(r),i=a.find((e=>"name"===e||"value"===e));if(i)n.name=r[i];else{const e=a.find((e=>Array.isArray(r[e])));n.name=e||s}const d=a.find((e=>Array.isArray(r[e])));return d&&(n.c=r[d].map((e=>"string"==typeof e?{name:e}:t(e,d)))),n}return r};return t(e,Object.keys(e)[0])},ConvertToJSON(e,t){const r=e.split("\n").map((e=>({name:e.trim()})));return{name:t.replace(/\.[^/.]+$/,""),c:r}}},mounted(){announce("App Initialized"),UseDebug&&this.PreFillForDevelopment(),window.addEventListener("keydown",this.HandleKeyDown),window.addEventListener("mouseup",this.HandleMouseUp)},computed:{getAllIdeaSetsSortedAlphabetically:function(){return this.allIdeaSets.sort(((e,t)=>{const r=e.name.slice(3).trim().toLowerCase(),s=t.name.slice(3).trim().toLowerCase();return r<s?-1:r>s?1:0}))},getIdeasFromCurrentGenerationBasedOnMethod:function(){if(null===this.currentIdeas)return[];let e=(null===this.currentSelectedIdea.parent?this.currentSelectedIdea:this.currentSelectedIdea.parent).children;0===e.filter((e=>!e.seen&&!e.isSelected)).length&&(e=this.currentSelectedIdea.children);const t=1===e.filter((e=>e.isSelected)).length?e.filter((e=>e.isSelected))[0]:null;let r=[];switch(this.currentMethod.value){case"binary":r=e.filter((e=>!e.seen&&!e.isSelected));for(let e=r.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}if(null===t){let e=r.slice(0,2);e.forEach((e=>{e.showing=!0})),r=e}else{const e=r.slice(0,1);e[0].showing=!0;const s=[e[0],t];s.sort((()=>Math.random()-.5)),r=s}break;case"full":case"merge":r=this.GetFirstUnfinishedGenerationOfExploredLineage(this.currentIdeas,!1),r.forEach((e=>{e.isSelected&&e.parent===this.currentIdeas&&(e.lowestSelectedDescendent=this.FindDeepestSelected(e).name)})),r=this.SortIdeasByOrderThenAlphabetically(r);default:break}return r},getLastSelectedIdea:function(){return this.selectedIdeasPath[this.selectedIdeasPath.length-1]},getLowestSelectedDescendantsComputed:function(){const e=[];if("binary"===this.currentMethod.value){const t=this.FindDeepestSelected(this.currentIdeas);t&&e.push(t)}else for(let t of this.currentIdeas.children){const r=this.FindDeepestSelected(t);r&&e.push(r)}return e},showAIActions:function(){let e=!1;if(this.currentIdeas)switch(this.currentMethod.value){case"binary":e=this.currentIdeas.children.every((e=>!0===e.seen));break;case"merge":e=this.currentIdeas.children.some((e=>""!==e.lowestSelectedDescendent));break;default:e=this.getIdeasFromCurrentGenerationBasedOnMethod.some((e=>Object.keys(e).every((t=>e[t]===this.currentIdeas.children[0][t]))&&Object.keys(this.currentIdeas.children[0]).every((t=>e[t]===this.currentIdeas.children[0][t])))),e&&(e=this.HasSelected(this.currentIdeas.children));break}return e},showExerciseResult:function(){if(this.currentIdeas&&"binary"===this.currentMethod.value)return this.currentIdeas.children.every((e=>!0===e.seen));if(!this.getIdeasFromCurrentGenerationBasedOnMethod.some((e=>Object.keys(e).every((t=>e[t]===this.currentIdeas.children[0][t]))&&Object.keys(this.currentIdeas.children[0]).every((t=>e[t]===this.currentIdeas.children[0][t])))))return!1;return!!this.HasSelected(this.currentIdeas.children)&&"full"===this.currentMethod.value},hydratedAIActions:function(){const e=[];return this.currentIdeaSet.AIActions.forEach((t=>{let r=new AIActionObject(t);r.request=r.request.replace("{{idea.name}}",'"'+this.getLastSelectedIdea.name+'"'),e.push(r)})),e}}});