Vue.config.devtools=!1,Vue.config.debug=!1,Vue.config.silent=!0,Vue.config.ignoredElements=["app"];var app=new Vue({el:"#app",data:{appVersion:"0.0.022",allMethods:Methods,allIdeaSets:IdeaSets,currentIdeaSet:new IdeaSetObject({}),currentIdeas:null,currentSelectedIdea:null,currentMethod:new MethodObject({}),currentMethodType:"",currentExerciseIsDirty:!1,selectedIdeasPath:[],ideasQueueForUndo:[],ideasQueueForRedo:[],visualStateLastInputEvent:null},methods:{async SelectIdeaSet(e){if(note("SelectIdeaSet() called"),this.currentIdeaSet=void 0===e?this.currentIdeaSet:e,null!==this.currentIdeaSet.data){let e=await this.GetCurrentIdeasJSON();this.currentIdeas=createNestedIdeaObject(e),this.currentMethod=this.currentIdeaSet.method,this.RestartExercise()}},SelectIdea(e,t=!0){note("SelectIdea(_idea) called");let s=0;e.parent.children&&e.parent.children.length>0&&(s=e.parent.children.length,Array.from(e.parent.children).forEach((e=>{e.isSelected=!1,(e.showing||"binary"!==this.currentMethod.value)&&(e.seen=!0),e.seen&&(s-=1)}))),e.isSelected=!0,0!==s&&"binary"===this.currentMethod.value||(this.currentSelectedIdea=e,this.selectedIdeasPath.push(e)),this.ideasQueueForUndo.push(e),t&&this.CleanDeselectedArrayBasedOnAncestry(e),this.currentExerciseIsDirty=!0,this.MoveFocus()},MoveFocus(){note("MoveFocus() called"),"keydown"===this.visualStateLastInputEvent&&this.$nextTick((()=>{void 0===this.getLastSelectedIdea||this.getLastSelectedIdea.children.length>0||0===this.selectedIdeasPath.length?document.getElementsByTagName("idea")[0].focus():document.getElementById("button-restart").focus()}))},UndoLastIdea(){if(this.ideasQueueForUndo.length>0){note("UndoLastIdea() called");let e=this.ideasQueueForUndo.pop();this.ideasQueueForRedo.push(e),e&&(this.getLastSelectedIdea===e?(this.selectedIdeasPath.pop(),void 0!==e.parent?e.parent===this.currentIdeas?this.RestartExercise():(this.currentSelectedIdea=e.parent,e.parent.children.forEach((e=>{this.ResetIdea(e,!0),this.MoveFocus()}))):this.RestartExercise(e)):(this.ResetIdea(e,!0),this.MoveFocus()))}},RedoLastIdea(){if(this.ideasQueueForRedo.length>0){note("RedoLastIdea() called");let e=this.ideasQueueForRedo.pop();e?this.SelectIdea(e,!1):this.MoveFocus()}},async GetCurrentIdeasJSON(){note("getCurrentIdeasJSON() called");let e=[],t=this.currentIdeaSet.data.map((e=>fetch(e).then((e=>e.json()))));try{let s=await Promise.all(t);e=[].concat(...s)}catch(e){e(e)}return e[0]},RestartExercise(){note("RestartExercise() called"),this.selectedIdeasPath=[],this.ideasQueueForUndo=[],this.currentExerciseIsDirty=!1,this.currentSelectedIdea=this.currentIdeas,this.currentMethodType=this.currentMethod.value,this.ResetIdea(this.currentIdeas),this.currentIdeas.isSelected=!0,this.currentIdeas.seen=!0,this.MoveFocus()},GetSelectedIdeasGetSelectedIdeasRecursively(e){if(note('GetSelectedIdeas("'+e.name+'") called'),!e.isSelected)return null;const t=e.children.map(this.GetSelectedIdeasRecursively).filter((e=>null!==e));return{...e,children:t}},CleanDeselectedArrayBasedOnAncestry(e){let t=new Set,s=e;for(;s;)t.add(s),s=s.parent;this.ideasQueueForRedo=this.ideasQueueForRedo.filter((e=>{t.has(e)&&this.currentIdeas}))},ResetIdea(e,t=!1){t&&highlight('Undoing "'+e.name+'"'),e.isSelected=!1,e.seen=!1,e.showing=!1,e.children&&e.children.length>0&&e.children.forEach((e=>{this.ResetIdea(e)}))},HandleKeyDown(e){switch(note("HandleKeyDown() called"),e.key){case"z":case"Z":this.currentMethod.allowUndo&&e.metaKey&&(e.shiftKey?this.RedoLastIdea():this.UndoLastIdea());break;default:break}this.visualStateLastInputEvent="keydown"},HandleMouseUp(){note("HandleMouseUp() called"),this.visualStateLastInputEvent="mouseup"}},mounted(){announce("App Initialized"),window.addEventListener("keydown",this.HandleKeyDown),window.addEventListener("mouseup",this.HandleMouseUp)},computed:{getIdeasFromCurrentLevelBasedOnMethod:function(){if(note("getRandomIdeasFromCurrentIdeasLevel() called"),null===this.currentIdeas)return[];let e=(null===this.currentSelectedIdea.parent?this.currentSelectedIdea:this.currentSelectedIdea.parent).children;0===e.filter((e=>!e.seen&&!e.isSelected)).length&&(e=this.currentSelectedIdea.children);const t=1===e.filter((e=>e.isSelected)).length?e.filter((e=>e.isSelected))[0]:null;let s=[];switch(this.currentMethod.value){case"binary":s=e.filter((e=>!e.seen&&!e.isSelected));for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}if(null===t){let e=s.slice(0,2);e.forEach((e=>{e.showing=!0})),s=e}else{const e=s.slice(0,1);e[0].showing=!0;const a=[e[0],t];a.sort((()=>Math.random()-.5)),s=a}break;case"full":s=e.filter((e=>!e.seen&&!e.isSelected)),s.sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0));break;case"merge":default:break}return s},getLastSelectedIdea:function(){return this.selectedIdeasPath[this.selectedIdeasPath.length-1]},getAllSelectedIdeasRecursively:function(){return note("getAllSelectedIdeasRecursively() called"),this.GetSelectedIdeas(this.currentIdeas)}}});